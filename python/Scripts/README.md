# Python Code Examples

This folder contains example Python scripts that generate, process, and validate material content using the MaterialX API.

## Scripts

| Script | Description |
|--------|-------------|
| `baketextures.py` | Bake procedural textures to image files |
| `comparenodedefs.py` | Compare node definitions between spec and library |
| `comparetraces.py` | Compare Perfetto trace files for performance analysis |
| `creatematerial.py` | Create MaterialX materials programmatically |
| `generateshader.py` | Generate shader code from MaterialX documents |
| `genmdl.py` | Generate MDL from MaterialX |
| `mxdoc.py` | Document MaterialX files |
| `mxformat.py` | Format MaterialX XML files |
| `mxvalidate.py` | Validate MaterialX documents |
| `translateshader.py` | Translate shaders between formats |

## Performance Analysis

The `comparetraces.py` script analyzes Perfetto trace files generated by MaterialX tests
when built with `MATERIALX_BUILD_TRACING=ON`. It compares baseline and optimized runs
to identify performance improvements (negative delta = time saved) and regressions.

```bash
# Install dependencies
pip install perfetto pandas matplotlib

# Compare two trace files
python comparetraces.py baseline.perfetto-trace optimized.perfetto-trace

# Filter by track, ignore small deltas, and export chart
python comparetraces.py base/ opt/ --track GPU --min-delta-ms 1 --chart chart.png

# Export full results to CSV
python comparetraces.py base/ opt/ --track GPU --csv results.csv
```

### Options

| Option | Description |
|--------|-------------|
| `--track`, `-t` | Filter by track name (e.g., `GPU`, `ShaderGen`) |
| `--min-delta-ms` | Minimum absolute time difference to include (filters noise) |
| `--chart`, `-c` | Output path for chart image (requires matplotlib) |
| `--csv` | Export results to CSV file (requires pandas) |
| `--open-matplotlib` | Display chart interactively |
| `--show-opt OPT_NAME` | Highlight materials affected by optimization (e.g., `optReplaceBsdfMixWithLinearCombination`) |

### Optimization Tracking

When using `--show-opt`, the script finds optimization pass events in the trace and
identifies affected materials from the parent shader generation slice. Affected materials
are marked with `*` in the table and `â˜…` in chart labels (bold purple text).

The script also validates that the baseline trace does NOT have the optimization enabled.